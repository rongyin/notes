
### Class类文件结构
#### 常量池
常量池包括字面量 (Literal) 和符号引用 (Symbolic References)。
##### 字面量
比较接近语言层面的常量概念，如文本字符串，声明为final的常量值等。
##### 符号引用
Java代码在编译的时候，并不像C和C++那样有连接步骤，而是虚拟机加载Class文件时进行动态连接。即在Class文件中不保存各个方法，字段的最终内存布局信息。因此这些方法字段的符号引用不经过运行期转换则无法得到对象真正的内存入口地址，也就无法被虚拟机使用。当虚拟机运行时，需要从常量池获得对应的符号引用，再在类创建时或运行时解析，翻译到具体内存地址。
符号引用包括以下三类常量
* 类和接口的全限定名。
* 字段的名称和描述符。
* 方法的名称和描述符。

#### 方法表
##### 方法重载
重载 (overload) 一个方法，除了要与原方法具有相同的简单名称外，还需要拥有一个与原方法不同的特征签名。
##### 特征签名
特征签名是一个方法中各个参数在常量池中的字段符号引用的集合，而方法返回值不在特征签名中。因此无法根据返回值对一个已有方法进行重载。但在Class文件结构中，特征签名的范围可以更大些，只要描述符不是完全一致的两个方法可以共存。即如果两个方法有相同的名称和特征签名，但返回值不同，那么也可以合法共存于同一个Class文件中。
***

### 对象的存储结构
* 对象头 (Header)
* 实例数据 (Instance Data)
* 对齐填充 (Padding)

#### 对象头结构
* 标记字段 (Mark Word)
* 类型指针 (Klass Pointer)

##### 标记字段结构
存储对象自身的运行时数据，而这些数据与对象自身定义无关。
* 哈希码
* GC分代年龄
* 锁状态标志
* 线程持有的锁
* 偏向线程ID
* 偏向时间戳

##### 标记字段存储内容
运行期间标记字段里存储的值会随着锁标志位的变化而变化。

锁状态|25bit|4bit|1bit (是否偏向锁) |25bit (锁标志位)
:-|:-|:-|:-|:-
无锁状态|对象的HashCode|对象分代年龄|0|01
偏向锁|线程ID和Epoch|对象分代年龄|1|01
轻量级锁|指向栈中锁记录的指针|||00
重量级锁|指向重量级锁的指针|||10
GC标记|空|||11

##### 类型指针
对象指向它的类元数据的指针，JVM通过这个指针来确定这个对象类型 (即哪个类的实例) 。但不是所有JVM都必须在对象数据上保留类型指针，即对象的元数据不一定要通过对象本身。
***
